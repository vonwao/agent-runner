# df05 Results: Validate --window Option

## Summary
| Metric | Value |
|--------|-------|
| Run ID | 20251228043055 |
| Status | **REVIEW LOOP (BUG)** |
| Stop Reason | (still running / manually stopped) |
| Duration | 7+ minutes (and counting) |
| Milestones | 0/1 completed (code done, stuck in review) |
| Worker Calls | 12+ claude, 0 codex |
| Retries | 0 (bug: not incrementing) |
| Risk Score | 0 |

## Bug Discovered: Review Loop

**Critical Bug Found:** The run got stuck in an infinite loop between IMPLEMENT and REVIEW phases.

### Root Cause
1. Done checks include CLI behavior tests: `npx agent metrics --window 0` prints error, etc.
2. Verification tier only runs `npm run build`
3. Reviewer sees verification_evidence and correctly notes "only build was run"
4. Reviewer returns `status: "request_changes"`
5. Implementer re-implements, says "I tested it manually"
6. Back to step 2... forever

### Impact
- `request_changes` status doesn't increment `milestone_retries`
- No max retries limit on review loops
- Wastes API calls (12+ claude calls for a 1-milestone task)
- Will eventually hit max_ticks (50) and stop

### Fix Needed
- Count `request_changes` as a retry, or
- Limit review loops separately, or
- Have reviewer trust implementer's handoff_memo when verification passes

## Timeline (Partial)
```
Started:  2025-12-28T04:31:07.652Z
Last update: 2025-12-28T04:38:41.364Z
Duration: 7+ minutes (still running)
```

## Review Loop Evidence
```
seq 12: review_complete -> request_changes
seq 19: review_complete -> request_changes
seq 26: review_complete -> request_changes
seq 33: review_complete -> request_changes
seq 40: review_complete -> request_changes
... (continuing)
```

## Code Implementation (Actually Correct)
The implementer did add the correct validation at src/cli.ts:215-222:
- Checks if window value is NaN or <= 0
- Prints "Error: --window must be a positive integer"
- Exits with code 1
- But this never got checkpointed due to review loop

## Worker Stats (at seq 41)
```json
{
  "claude": 12,
  "codex": 0,
  "by_phase": {
    "plan": { "claude": 1, "codex": 0 },
    "implement": { "claude": 6, "codex": 0 },
    "review": { "claude": 5, "codex": 0 }
  }
}
```

## Branch
```
agent/20251228043055/df05-validate-window-option
```

## Actionable Bugs for v0.2.0
1. **Review loop detection** - Add counter for consecutive `request_changes` and fail after N
2. **request_changes as retry** - Increment `milestone_retries` on `request_changes`
3. **Verification scope gap** - Done checks mentioning CLI commands can't be verified by build-only tier
